{% extends 'admin/admin_base.html' %}

{% block title %}Create Blog Post{% endblock %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
{% endblock %}

{% block content %}

<div class="admin-wrapper">

  <!-- Sidebar -->
  {% include 'partials/admin_nav.html' %}

  <!-- Main Content -->
  <main class="admin-main">
    <!-- Top Row -->
    <div class="admin-topbar">
      <div class="page-title">
        <h2>Create New Blog Post</h2>
      </div>
      <div class="user-info">
        <span class="user-email">{{ (current_user and current_user.email) or 'admin@atlantalocals' }}</span>
        <span class="user-avatar">ðŸ‘¤</span>
      </div>
    </div>

    <!-- Content Form -->
    <div class="admin-content-container">
      <div class="content-card">
        <form method="POST"
              action="{{ url_for('main.admin_create_blog_post') }}"
              enctype="multipart/form-data">

          {{ post_form.hidden_tag() }}
          {{ content_form.hidden_tag() }}

          {# Top-level error summary #}
          {% if post_form.errors or content_form.errors %}
            <div class="form-alert form-alert--error" role="alert" style="margin-bottom:16px;">
              Please correct the errors highlighted below.
            </div>
          {% endif %}

          <!-- Title -->
          <div class="form-group">
            <label for="{{ post_form.title.id }}">Post Title</label>
            {{ post_form.title(class_="input", required=True) }}
            {% for e in post_form.title.errors %}<div class="error">{{ e }}</div>{% endfor %}
          </div>

          <!-- Slug -->
          <div class="form-group">
            <label for="{{ post_form.slug.id }}">Slug</label>
            {{ post_form.slug(class_="input", required=True) }}
            {% for e in post_form.slug.errors %}<div class="error">{{ e }}</div>{% endfor %}
          </div>

          <!-- Category -->
          <div class="form-group">
            <label for="{{ post_form.blog_cat_id.id }}">Category</label>
            {{ post_form.blog_cat_id(class_="select", required=True) }}
            {% for e in post_form.blog_cat_id.errors %}<div class="error">{{ e }}</div>{% endfor %}
          </div>

          <!-- Author -->
          <div class="form-group">
            <label for="{{ post_form.author_id.id }}">Author</label>
            {{ post_form.author_id(class_="select", required=True) }}
            {% for e in post_form.author_id.errors %}<div class="error">{{ e }}</div>{% endfor %}
          </div>

          <!-- Image -->
          <div class="form-group">
            <label for="{{ post_form.image.id }}">Featured Image</label>
            {{ post_form.image(class_="input", accept="image/*") }}
            {% for e in post_form.image.errors %}<div class="error">{{ e }}</div>{% endfor %}
            <div class="image-preview" data-image-preview style="margin-top:8px;display:none;">
              <img alt="Preview" style="max-width:240px;border-radius:8px;box-shadow:var(--shadow-sm);" />
            </div>
          </div>

          <!-- YouTube Video ID (Watch Now) -->
          <div class="form-group">
            <label for="{{ content_form.yt_vid_id.id }}">YouTube Video ID</label>
            {{ content_form.yt_vid_id(class_="input", placeholder="e.g. 4AaaTmxpJe8") }}
            {% for e in content_form.yt_vid_id.errors %}<div class="error">{{ e }}</div>{% endfor %}
          </div>

          <!-- Content -->
          <div class="form-group" id="content-sections">
            <h3>Content</h3>

            <!-- Section 1 -->
            <div class="content-section" data-section="section-1">
              <h4>Section 1</h4>

              <label for="{{ content_form.section_1_title.id }}">Title</label>
              {{ content_form.section_1_title(class_="input", required=True) }}
              {% for e in content_form.section_1_title.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label for="{{ content_form.section_1_paragraph_1.id }}">Paragraph 1</label>
              {{ content_form.section_1_paragraph_1(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_1_paragraph_1.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label for="{{ content_form.section_1_paragraph_2.id }}">Paragraph 2</label>
              {{ content_form.section_1_paragraph_2(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_1_paragraph_2.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label for="{{ content_form.section_1_paragraph_3.id }}">Paragraph 3</label>
              {{ content_form.section_1_paragraph_3(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_1_paragraph_3.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label for="{{ content_form.section_1_img.id }}">Image (URL)</label>
              {{ content_form.section_1_img(class_="input", placeholder="/static/images/...") }}

              <label for="{{ content_form.section_1_link_internal.id }}">Internal Link</label>
              {{ content_form.section_1_link_internal(class_="input") }}

              <label for="{{ content_form.section_1_link_external.id }}">External Link</label>
              {{ content_form.section_1_link_external(class_="input") }}
            </div>

            <!-- Section 2 -->
            <div class="content-section" data-section="section-2">
              <h4>Section 2</h4>

              <label>Title</label>
              {{ content_form.section_2_title(class_="input", required=True) }}
              {% for e in content_form.section_2_title.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 1</label>
              {{ content_form.section_2_paragraph_1(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_2_paragraph_1.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 2</label>
              {{ content_form.section_2_paragraph_2(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_2_paragraph_2.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 3</label>
              {{ content_form.section_2_paragraph_3(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_2_paragraph_3.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Image (URL)</label>
              {{ content_form.section_2_img(class_="input", placeholder="/static/images/...") }}

              <label>Internal Link</label>
              {{ content_form.section_2_link_internal(class_="input") }}

              <label>External Link</label>
              {{ content_form.section_2_link_external(class_="input") }}
            </div>

            <!-- Section 3 -->
            <div class="content-section" data-section="section-3">
              <h4>Section 3</h4>

              <label>Title</label>
              {{ content_form.section_3_title(class_="input", required=True) }}
              {% for e in content_form.section_3_title.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 1</label>
              {{ content_form.section_3_paragraph_1(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_3_paragraph_1.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 2</label>
              {{ content_form.section_3_paragraph_2(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_3_paragraph_2.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 3</label>
              {{ content_form.section_3_paragraph_3(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_3_paragraph_3.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Image (URL)</label>
              {{ content_form.section_3_img(class_="input", placeholder="/static/images/...") }}

              <label>Internal Link</label>
              {{ content_form.section_3_link_internal(class_="input") }}

              <label>External Link</label>
              {{ content_form.section_3_link_external(class_="input") }}
            </div>

            <!-- Section 4 -->
            <div class="content-section" data-section="section-4">
              <h4>Section 4</h4>

              <label>Title</label>
              {{ content_form.section_4_title(class_="input", required=True) }}
              {% for e in content_form.section_4_title.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 1</label>
              {{ content_form.section_4_paragraph_1(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_4_paragraph_1.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 2</label>
              {{ content_form.section_4_paragraph_2(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_4_paragraph_2.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 3</label>
              {{ content_form.section_4_paragraph_3(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_4_paragraph_3.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Image (URL)</label>
              {{ content_form.section_4_img(class_="input", placeholder="/static/images/...") }}

              <label>Internal Link</label>
              {{ content_form.section_4_link_internal(class_="input") }}

              <label>External Link</label>
              {{ content_form.section_4_link_external(class_="input") }}
            </div>

            <!-- Section 5 -->
            <div class="content-section" data-section="section-5">
              <h4>Section 5</h4>

              <label>Title</label>
              {{ content_form.section_5_title(class_="input", required=True) }}
              {% for e in content_form.section_5_title.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 1</label>
              {{ content_form.section_5_paragraph_1(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_5_paragraph_1.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 2</label>
              {{ content_form.section_5_paragraph_2(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_5_paragraph_2.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 3</label>
              {{ content_form.section_5_paragraph_3(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_5_paragraph_3.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Image (URL)</label>
              {{ content_form.section_5_img(class_="input", placeholder="/static/images/...") }}

              <label>Internal Link</label>
              {{ content_form.section_5_link_internal(class_="input") }}

              <label>External Link</label>
              {{ content_form.section_5_link_external(class_="input") }}
            </div>

            <!-- Section 6 (Conclusion) -->
            <div class="content-section" data-section="section-6-conclusion">
              <h4>Section 6 â€” Conclusion</h4>

              <label>Title</label>
              {{ content_form.section_6_conclusion_title(class_="input", required=True) }}
              {% for e in content_form.section_6_conclusion_title.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 1</label>
              {{ content_form.section_6_conclusion_paragraph_1(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_6_conclusion_paragraph_1.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 2</label>
              {{ content_form.section_6_conclusion_paragraph_2(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_6_conclusion_paragraph_2.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 3</label>
              {{ content_form.section_6_conclusion_paragraph_3(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_6_conclusion_paragraph_3.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Image (URL)</label>
              {{ content_form.section_6_conclusion_img(class_="input", placeholder="/static/images/...") }}

              <label>Internal Link</label>
              {{ content_form.section_6_conclusion_link_internal(class_="input") }}

              <label>External Link</label>
              {{ content_form.section_6_conclusion_link_external(class_="input") }}
            </div>

            <!-- Section 7 (Associated Press / attribution) -->
            <div class="content-section" data-section="section-7-assoc-press">
              <h4>Section 7 â€” Associated Press</h4>

              <label>Title</label>
              {{ content_form.section_7_assoc_press_title(class_="input", required=True) }}
              {% for e in content_form.section_7_assoc_press_title.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Paragraph 1</label>
              {{ content_form.section_7_assoc_press_paragraph_1(class_="textarea", rows=3, required=True) }}
              {% for e in content_form.section_7_assoc_press_paragraph_1.errors %}<div class="error">{{ e }}</div>{% endfor %}

              <label>Image (URL)</label>
              {{ content_form.section_7_assoc_press_img(class_="input", placeholder="/static/images/...") }}

              <label>Internal Link</label>
              {{ content_form.section_7_assoc_press_link_internal(class_="input") }}

              <label>External Link</label>
              {{ content_form.section_7_assoc_press_link_external(class_="input") }}
            </div>

            <!-- Section 8 â€” FAQs -->
            <div class="content-section" data-section="section-8-faqs">
              <h4>Section 8 â€” FAQs</h4>

              <div class="form-grid form-grid--2">
                <div>
                  <label>Q1</label>
                  {{ content_form.faq_q_1(class_="textarea", rows=3, required=True) }}
                  {% for e in content_form.faq_q_1.errors %}<div class="error">{{ e }}</div>{% endfor %}
                </div>
                <div>
                  <label>A1</label>
                  {{ content_form.faq_a_1(class_="textarea", rows=3, required=True) }}
                  {% for e in content_form.faq_a_1.errors %}<div class="error">{{ e }}</div>{% endfor %}
                </div>

                <div>
                  <label>Q2</label>
                  {{ content_form.faq_q_2(class_="textarea", rows=3, required=True) }}
                  {% for e in content_form.faq_q_2.errors %}<div class="error">{{ e }}</div>{% endfor %}
                </div>
                <div>
                  <label>A2</label>
                  {{ content_form.faq_a_2(class_="textarea", rows=3, required=True) }}
                  {% for e in content_form.faq_a_2.errors %}<div class="error">{{ e }}</div>{% endfor %}
                </div>

                <div>
                  <label>Q3</label>
                  {{ content_form.faq_q_3(class_="textarea", rows=3, required=True) }}
                  {% for e in content_form.faq_q_3.errors %}<div class="error">{{ e }}</div>{% endfor %}
                </div>
                <div>
                  <label>A3</label>
                  {{ content_form.faq_a_3(class_="textarea", rows=3, required=True) }}
                  {% for e in content_form.faq_a_3.errors %}<div class="error">{{ e }}</div>{% endfor %}
                </div>

                <div>
                  <label>Q4</label>
                  {{ content_form.faq_q_4(class_="textarea", rows=3) }}
                </div>
                <div>
                  <label>A4</label>
                  {{ content_form.faq_a_4(class_="textarea", rows=3) }}
                </div>

                <div>
                  <label>Q5</label>
                  {{ content_form.faq_q_5(class_="textarea", rows=3) }}
                </div>
                <div>
                  <label>A5</label>
                  {{ content_form.faq_a_5(class_="textarea", rows=3) }}
                </div>

                <div>
                  <label>Q6</label>
                  {{ content_form.faq_q_6(class_="textarea", rows=3) }}
                </div>
                <div>
                  <label>A6</label>
                  {{ content_form.faq_a_6(class_="textarea", rows=3) }}
                </div>
              </div>
            </div>
          </div>

          <!-- Submit -->
          <div class="form-group">
            <button type="submit" class="btn-select">Publish Post</button>
          </div>

        </form>
      </div>
    </div>
  </main>
</div>

{% endblock %}
{% block scripts %}
  {{ super() }}
  {# Keep your per-page JS. It should NOT call the API anymore; just helpers like slugify/preview. #}
  <script src="{{ url_for('static', filename='js/blog_create.js') }}"></script>
{% endblock %}
